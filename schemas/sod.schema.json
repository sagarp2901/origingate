{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.org/schemas/sod.schema.json",
  "title": "SoftwareOriginDossier",
  "type": "object",
  "required": [
    "product",
    "artifact",
    "provenance",
    "sbom",
    "signing"
  ],
  "properties": {
    "product": {
      "type": "object",
      "required": [
        "name",
        "version"
      ],
      "properties": {
        "name": {
          "type": "string"
        },
        "version": {
          "type": "string"
        }
      }
    },
    "artifact": {
      "type": "object",
      "required": [
        "digest"
      ],
      "properties": {
        "digest": {
          "type": "string"
        },
        "uri": {
          "type": "string"
        }
      }
    },
    "provenance": {
      "type": "object",
      "required": [
        "builder_id",
        "build_region",
        "timestamp",
        "source_repo",
        "commit"
      ],
      "properties": {
        "builder_id": {
          "type": "string"
        },
        "build_region": {
          "type": "string"
        },
        "timestamp": {
          "type": "string"
        },
        "source_repo": {
          "type": "string"
        },
        "commit": {
          "type": "string"
        }
      }
    },
    "sbom": {
      "type": "object",
      "required": [
        "format",
        "components"
      ],
      "properties": {
        "format": {
          "type": "string"
        },
        "components": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "name",
              "version",
              "supplier_jurisdiction",
              "criticality",
              "foreign_control_risk"
            ],
            "properties": {
              "name": {
                "type": "string"
              },
              "version": {
                "type": "string"
              },
              "supplier_jurisdiction": {
                "type": "string"
              },
              "criticality": {
                "type": "string",
                "enum": [
                  "crypto",
                  "auth",
                  "network",
                  "data",
                  "ui",
                  "other"
                ]
              },
              "foreign_control_risk": {
                "type": "number",
                "minimum": 0,
                "maximum": 1
              }
            }
          }
        }
      }
    },
    "signing": {
      "type": "object",
      "required": [
        "key_jurisdiction",
        "signature"
      ],
      "properties": {
        "key_jurisdiction": {
          "type": "string"
        },
        "signature": {
          "type": "string"
        }
      }
    },
    "hosting": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string"
        },
        "control_plane_region": {
          "type": "string"
        },
        "jurisdiction": {
          "type": "string"
        }
      }
    },
    "attestation": {
      "type": "object"
    }
  }
}